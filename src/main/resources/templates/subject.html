<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Danh s√°ch m√¥n</title>
  <link rel="stylesheet" href="/css/common.css">
  <link rel="stylesheet" href="/css/subject.css">
</head>
<body>
<header>
  <a href="/home" class="logo">
    <h1>Thi<span>Tot</span></h1>
  </a>
  <nav class="menu">
    <ul>
      <li><a href="/profile">Th√¥ng tin c√° nh√¢n</a></li>
      <li><a href="/exam">ƒê·ªÅ thi</a></li>
      <li><a href="/subject">Luy·ªán t·∫≠p</a></li>
      <li><a href="/history">L·ªãch s·ª≠ thi</a></li>
      <li th:if="${user != null}"><a href="/logout">ƒêƒÉng xu·∫•t</a></li>
      <li th:unless="${user != null}"><a href="/login">ƒêƒÉng nh·∫≠p</a></li>
    </ul>
  </nav>
</header>

  <main>
    <div class="header-row">
      <h2>Danh s√°ch m√¥n</h2>
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm m√¥n h·ªçc...">
        <button id="searchBtn">üîç</button>
      </div>
    </div>

    <div class="subject-container" id="subjectList">
      <!-- Thymeleaf loop -->
      <div class="subject-card" th:each="sub : ${subjects}">
        <p class="subject-title" th:text="${sub.subjectName}">T√™n m√¥n</p>

        <img class="subject-img"
             th:src="${sub.imageUrl}"
             alt="·∫¢nh m√¥n h·ªçc"
            >

        <p class="subject-desc" th:text="${sub.description}">M√¥ t·∫£ m√¥n</p>

        <div class="button-group">
          <button class="btn btn-outline"
                  th:attr="data-name=${sub.subjectName}, data-desc=${sub.description}, data-time='45 ph√∫t', data-count='40 c√¢u'"
                  onclick="showDetails(this)">
            Chi ti·∫øt
          </button>

          <button class="btn btn-primary"
                  th:attr="data-name=${sub.subjectName}"
                  onclick="openExam(this)">
            V√†o thi
          </button>
        </div>
      </div>
    </div>


  </main>

  <footer>¬© 2025 ThiTot - N·ªÅn t·∫£ng thi tr·∫Øc nghi·ªám</footer>

<!-- Popup V√†o thi -->
<div class="overlay" id="popupExam">
  <div class="popup">
    <button class="close-btn" onclick="closePopup('popupExam')">‚úñ</button>
    <h3>V√†o Thi</h3>
    <label>M√¥n thi</label>
    <input id="subjectName" readonly>
    <label>ƒê·ªô kh√≥</label>
    <select id="difficulty">
      <option>D·ªÖ</option>
      <option>Trung b√¨nh</option>
      <option>Kh√≥</option>
    </select>
    <label>S·ªë l∆∞·ª£ng c√¢u h·ªèi</label>
    <select id="questionCount">
      <option>40</option>
      <option>50</option>
      <option>60</option>
    </select>
    <button class="submit" onclick="submitExam()">L∆∞u</button>
  </div>
</div>

<!-- Popup Chi ti·∫øt -->
<div class="overlay" id="popupDetails">
  <div class="popup popup-details">
    <button class="close-btn" onclick="closePopup('popupDetails')">‚úñ</button>
    <h3>Chi ti·∫øt m√¥n h·ªçc</h3>
    <p><strong>T√™n m√¥n:</strong> <span id="detailName"></span></p>
    <p><strong>M√¥ t·∫£:</strong> <span id="detailDesc"></span></p>
    <p><strong>Th·ªùi gian l√†m b√†i:</strong> <span id="detailTime"></span></p>
    <p><strong>S·ªë l∆∞·ª£ng c√¢u h·ªèi:</strong> <span id="detailCount"></span></p>
  </div>
</div>

<script>
  const searchInput = document.getElementById("searchInput");
  const searchBtn = document.getElementById("searchBtn");
  const subjectCards = Array.from(document.querySelectorAll(".subject-card"));

  // T√¨m ki·∫øm
  function searchSubjects() {
    const keyword = searchInput.value.trim().toLowerCase();
    subjectCards.forEach(card => {
      const title = card.querySelector(".subject-title").innerText.toLowerCase();
      card.style.display = title.includes(keyword) ? "block" : "none";
    });
  }

  searchBtn.addEventListener("click", searchSubjects);
  searchInput.addEventListener("input", searchSubjects);

  // Popup Chi ti·∫øt
  function showDetails(btn) {
    document.getElementById('detailName').innerText = btn.getAttribute('data-name');
    document.getElementById('detailDesc').innerText = btn.getAttribute('data-desc');
    document.getElementById('detailTime').innerText = btn.getAttribute('data-time');
    document.getElementById('detailCount').innerText = btn.getAttribute('data-count');
    document.getElementById('popupDetails').classList.add('active');
  }

  // Popup V√†o thi
  function openExam(btn) {
    document.getElementById('subjectName').value = btn.getAttribute('data-name');
    document.getElementById('popupExam').classList.add('active');
  }

  function closePopup(id) {
    document.getElementById(id).classList.remove('active');
  }

  function submitExam() {
    const subject = document.getElementById('subjectName').value;
    const difficulty = document.getElementById('difficulty').value;
    const questionCount = document.getElementById('questionCount').value;
    alert(`B·∫Øt ƒë·∫ßu thi m√¥n ${subject}\nƒê·ªô kh√≥: ${difficulty}\nS·ªë c√¢u h·ªèi: ${questionCount}`);
    closePopup('popupExam');
  }
</script>
</body>
</html>
